<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VaaS ROI Calculator - Professional</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --primary: #80331A;
            --accent: #D6B366;
            --dark: #0A0A0A;
            --light: #FFFFFF;
            --gray: #9CA3AF;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--dark) 0%, #050505 100%);
            color: var(--light);
            min-height: 100vh;
        }

        .hero {
            padding: 4rem 2rem;
            text-align: center;
            background: radial-gradient(circle, rgba(128, 51, 26, 0.1) 0%, transparent 70%);
        }

        .hero h1 {
            font-size: clamp(3rem, 8vw, 6rem);
            font-weight: 900;
            background: linear-gradient(135deg, var(--light) 0%, var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .hero p { 
            font-size: 1.25rem; 
            color: var(--gray); 
            margin: 0 auto 3rem; 
            max-width: 600px; 
            line-height: 1.6;
        }
        
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 0 2rem; 
        }

        /* Navigation */
        .nav {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: rgba(128, 51, 26, 0.05);
            border: 1px solid rgba(214, 179, 102, 0.1);
            color: var(--light);
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .nav-btn.active {
            background: linear-gradient(135deg, var(--primary) 0%, #9B4D2A 100%);
            border-color: var(--accent);
            box-shadow: 0 0 20px rgba(214, 179, 102, 0.3);
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(214, 179, 102, 0.2);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeInUp 0.6s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        /* Steps */
        .steps {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 3rem;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .step {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all 0.4s ease;
        }

        .step.active {
            background: linear-gradient(135deg, var(--accent) 0%, #E5C77A 100%);
            color: var(--dark);
            box-shadow: 0 0 30px rgba(214, 179, 102, 0.4);
            transform: scale(1.1);
        }

        .step.inactive {
            background: rgba(128, 51, 26, 0.05);
            border: 2px solid rgba(214, 179, 102, 0.1);
            color: var(--gray);
        }

        .step-connector {
            width: 60px;
            height: 2px;
            background: linear-gradient(90deg, var(--accent) 0%, rgba(214, 179, 102, 0.1) 100%);
            opacity: 0.3;
        }
        
        .form-card {
            background: rgba(128, 51, 26, 0.05);
            border: 1px solid rgba(214, 179, 102, 0.1);
            border-radius: 20px;
            padding: 2.5rem;
            backdrop-filter: blur(20px);
            transition: all 0.3s ease;
            max-width: 600px;
            margin: 0 auto 2rem;
        }

        .form-card:hover {
            border-color: var(--accent);
            box-shadow: 0 20px 40px rgba(128, 51, 26, 0.1);
        }

        .form-card h2 { 
            color: var(--accent); 
            font-size: 1.8rem; 
            text-align: center; 
            margin-bottom: 2rem; 
            font-weight: 700;
        }
        
        .form-group { margin-bottom: 1.5rem; }
        .form-group label { 
            display: block; 
            color: var(--accent); 
            font-weight: 600; 
            margin-bottom: 0.5rem; 
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(214, 179, 102, 0.1);
            border-radius: 12px;
            color: var(--light);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(214, 179, 102, 0.1);
            background: rgba(255, 255, 255, 0.08);
        }

        .btn {
            background: linear-gradient(135deg, var(--primary) 0%, #9B4D2A 100%);
            color: var(--light);
            border: none;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 0.5rem 0.5rem 0;
        }

        .btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 10px 30px rgba(128, 51, 26, 0.4); 
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid rgba(214, 179, 102, 0.1);
            color: var(--accent);
        }

        .btn-secondary:hover {
            background: rgba(128, 51, 26, 0.05);
            border-color: var(--accent);
        }

        /* Templates Grid */
        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .template-card {
            background: rgba(128, 51, 26, 0.05);
            border: 1px solid rgba(214, 179, 102, 0.1);
            border-radius: 20px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .template-card:hover {
            transform: translateY(-4px);
            border-color: var(--accent);
            box-shadow: 0 15px 30px rgba(128, 51, 26, 0.15);
        }

        .template-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: block;
        }

        .template-card h4 {
            color: var(--accent);
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .template-card p {
            color: var(--gray);
            margin-bottom: 1rem;
            line-height: 1.4;
            font-size: 0.9rem;
        }

        .template-details {
            background: rgba(255, 255, 255, 0.05);
            padding: 0.75rem;
            border-radius: 8px;
            font-size: 0.8rem;
            color: var(--accent);
            border: 1px solid rgba(214, 179, 102, 0.1);
        }

        /* Results Grid */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .result-card {
            background: rgba(128, 51, 26, 0.05);
            border: 1px solid rgba(214, 179, 102, 0.1);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .result-card:hover {
            border-color: var(--accent);
            transform: translateY(-4px);
        }

        .result-card h4 {
            color: var(--accent);
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .result-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--accent);
            margin-bottom: 0.5rem;
        }

        /* Charts */
        .chart-container {
            background: rgba(128, 51, 26, 0.05);
            border: 1px solid rgba(214, 179, 102, 0.1);
            border-radius: 16px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .chart-title {
            color: var(--accent);
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            text-align: center;
        }

        .chart-placeholder {
            height: 200px;
            background: linear-gradient(45deg, rgba(128, 51, 26, 0.1), rgba(214, 179, 102, 0.1));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        /* Export Section */
        .export-section {
            background: rgba(128, 51, 26, 0.05);
            border: 1px solid rgba(214, 179, 102, 0.1);
            border-radius: 16px;
            padding: 1.5rem;
            margin: 2rem 0;
            text-align: center;
        }

        .export-section h3 {
            color: var(--accent);
            margin-bottom: 1rem;
        }

        .floating-element {
            position: absolute;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            border-radius: 20px;
            opacity: 0.1;
            animation: float 6s ease-in-out infinite;
        }

        .floating-element:nth-child(1) { top: 10%; left: 10%; }
        .floating-element:nth-child(2) { top: 20%; right: 15%; animation-delay: 2s; }
        .floating-element:nth-child(3) { bottom: 15%; left: 20%; animation-delay: 4s; }

        @keyframes float { 
            0%, 100% { transform: translateY(0px); } 
            50% { transform: translateY(-10px); } 
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        footer {
            margin-top: 4rem;
            padding: 2rem;
            text-align: center;
            border-top: 1px solid rgba(214, 179, 102, 0.1);
        }

        @media (max-width: 768px) {
            .hero { padding: 2rem 1rem; }
            .form-card { padding: 1.5rem; margin: 0 1rem 2rem; }
            .step-connector { width: 2px; height: 30px; }
            .steps { flex-direction: column; gap: 0.5rem; }
            .templates-grid { grid-template-columns: 1fr; }
            .results-grid { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
        }
    </style>
</head>
<body>
    <div class="floating-element"></div>
    <div class="floating-element"></div>
    <div class="floating-element"></div>

    <section class="hero">
        <div class="container">
            <h1>VaaS ROI Calculator</h1>
            <p>Transformieren Sie Ihre Gesch√§ftsprozesse mit pr√§zisen ROI-Berechnungen. Professionell, elegant und zukunftsweisend.</p>
        </div>
    </section>

    <div class="container">
        <!-- Navigation -->
        <nav class="nav">
            <button class="nav-btn active" onclick="showTab('calculator')">üßÆ Rechner</button>
            <button class="nav-btn" onclick="showTab('templates')">üè≠ Branchenvorlagen</button>
            <button class="nav-btn" onclick="showTab('results')">üìä Ergebnisse</button>
        </nav>

        <!-- Calculator Tab -->
        <div id="calculator-tab" class="tab-content active">
            <!-- Step Indicator -->
            <div class="steps">
                <div class="step active" id="step1">1</div>
                <div class="step-connector"></div>
                <div class="step inactive" id="step2">2</div>
                <div class="step-connector"></div>
                <div class="step inactive" id="step3">3</div>
            </div>

            <!-- Step 1: Basic Information -->
            <div id="step1-content" class="form-card">
                <h2>üìã Grundinformationen</h2>
                
                <div class="form-group">
                    <label for="companySize">Unternehmensgr√∂√üe</label>
                    <select id="companySize">
                        <option value="">Bitte w√§hlen...</option>
                        <option value="small">Klein (1-50 MA)</option>
                        <option value="medium">Mittel (51-250 MA)</option>
                        <option value="large">Gro√ü (250+ MA)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="industry">Branche</label>
                    <select id="industry">
                        <option value="">Bitte w√§hlen...</option>
                        <option value="tech">Technologie</option>
                        <option value="finance">Finanzen</option>
                        <option value="healthcare">Gesundheitswesen</option>
                        <option value="retail">Einzelhandel</option>
                        <option value="manufacturing">Produktion</option>
                        <option value="logistics">Logistik</option>
                        <option value="consulting">Beratung</option>
                        <option value="education">Bildung</option>
                        <option value="other">Sonstige</option>
                    </select>
                </div>
                
                <div style="text-align: center;">
                    <button class="btn" onclick="nextStep()">Weiter ‚Üí Schritt 2</button>
                </div>
            </div>

            <!-- Step 2: Cost Analysis -->
            <div id="step2-content" class="form-card" style="display: none;">
                <h2>üí∞ Kostenanalyse</h2>
                
                <div class="form-group">
                    <label for="monthlyPhoneCosts">Monatliche Telefoniekosten (‚Ç¨)</label>
                    <input type="number" id="monthlyPhoneCosts" placeholder="1000" min="0">
                </div>
                
                <div class="form-group">
                    <label for="monthlyITCosts">Monatliche IT-Administrationskosten (‚Ç¨)</label>
                    <input type="number" id="monthlyITCosts" placeholder="500" min="0">
                </div>
                
                <div class="form-group">
                    <label for="implementationCosts">Implementierungskosten VaaS (‚Ç¨)</label>
                    <input type="number" id="implementationCosts" placeholder="5000" min="0">
                </div>
                
                <div style="text-align: center;">
                    <button class="btn btn-secondary" onclick="previousStep()">‚Üê Zur√ºck</button>
                    <button class="btn" onclick="nextStep()">Weiter ‚Üí Schritt 3</button>
                </div>
            </div>

            <!-- Step 3: Savings & ROI -->
            <div id="step3-content" class="form-card" style="display: none;">
                <h2>üìà Einsparungen & ROI</h2>
                
                <div class="form-group">
                    <label for="monthlySavings">Erwartete monatliche Einsparungen (‚Ç¨)</label>
                    <input type="number" id="monthlySavings" placeholder="2000" min="0">
                </div>
                
                <div class="form-group">
                    <label for="implementationTime">Zeit bis zur vollen Implementierung (Monate)</label>
                    <input type="number" id="implementationTime" placeholder="3" min="1">
                </div>
                
                <div style="text-align: center;">
                    <button class="btn btn-secondary" onclick="previousStep()">‚Üê Zur√ºck</button>
                    <button class="btn" onclick="calculateROI()">üßÆ ROI Berechnen</button>
                </div>
            </div>
        </div>

        <!-- Templates Tab -->
        <div id="templates-tab" class="tab-content">
            <h2 style="color: var(--accent); text-align: center; margin-bottom: 2rem; font-size: 2rem;">üè≠ Branchenvorlagen</h2>
            
            <div class="templates-grid">
                <div class="template-card" onclick="loadTemplate('tech')">
                    <div class="template-icon">üíª</div>
                    <h4>Technologie</h4>
                    <p>Hohe IT-Kosten, agile Implementierung</p>
                    <div class="template-details">
                        Telefonie: 2000‚Ç¨ | IT: 1500‚Ç¨ | Zeit: 3 Monate | Ersparnis: 3500‚Ç¨
                    </div>
                </div>
                
                <div class="template-card" onclick="loadTemplate('finance')">
                    <div class="template-icon">üè¶</div>
                    <h4>Finanzen</h4>
                    <p>Compliance-orientiert, hohe Sicherheit</p>
                    <div class="template-details">
                        Telefonie: 3000‚Ç¨ | IT: 2000‚Ç¨ | Zeit: 6 Monate | Ersparnis: 5000‚Ç¨
                    </div>
                </div>
                
                <div class="template-card" onclick="loadTemplate('healthcare')">
                    <div class="template-icon">üè•</div>
                    <h4>Gesundheitswesen</h4>
                    <p>24/7 Verf√ºgbarkeit, strenger Datenschutz</p>
                    <div class="template-details">
                        Telefonie: 2500‚Ç¨ | IT: 1800‚Ç¨ | Zeit: 4 Monate | Ersparnis: 4000‚Ç¨
                    </div>
                </div>

                <div class="template-card" onclick="loadTemplate('retail')">
                    <div class="template-icon">üõçÔ∏è</div>
                    <h4>Einzelhandel</h4>
                    <p>Multi-Location, Kundenservice-fokussiert</p>
                    <div class="template-details">
                        Telefonie: 1800‚Ç¨ | IT: 1200‚Ç¨ | Zeit: 3 Monate | Ersparnis: 2800‚Ç¨
                    </div>
                </div>

                <div class="template-card" onclick="loadTemplate('manufacturing')">
                    <div class="template-icon">üè≠</div>
                    <h4>Produktion</h4>
                    <p>Robuste Systeme, Industrie 4.0</p>
                    <div class="template-details">
                        Telefonie: 2200‚Ç¨ | IT: 1600‚Ç¨ | Zeit: 5 Monate | Ersparnis: 3600‚Ç¨
                    </div>
                </div>

                <div class="template-card" onclick="loadTemplate('logistics')">
                    <div class="template-icon">üöö</div>
                    <h4>Logistik</h4>
                    <p>Standort√ºbergreifend, mobile Teams</p>
                    <div class="template-details">
                        Telefonie: 2800‚Ç¨ | IT: 1400‚Ç¨ | Zeit: 4 Monate | Ersparnis: 3800‚Ç¨
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Tab -->
        <div id="results-tab" class="tab-content">
            <h2 style="color: var(--accent); text-align: center; margin-bottom: 2rem; font-size: 2rem;">üìä ROI Berechnungsergebnis</h2>
            
            <div id="results-content" style="display: none;">
                <!-- Results will be populated here -->
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p style="color: var(--gray); font-size: 1rem;">
                Professioneller VaaS ROI Calculator f√ºr pr√§zise Kostenanalysen und Investitionsplanung.
            </p>
            <p style="color: var(--accent); font-size: 0.9rem;">
                Entwickelt mit modernem Design und berent.ai Farbpalette f√ºr optimale Benutzererfahrung.
            </p>
        </div>
    </footer>

    <script>
        let currentStep = 1;
        const totalSteps = 3;

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }

        function nextStep() {
            if (currentStep < totalSteps) {
                currentStep++;
                updateStepDisplay();
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepDisplay();
            }
        }

        function updateStepDisplay() {
            for (let i = 1; i <= totalSteps; i++) {
                document.getElementById('step' + i + '-content').style.display = 'none';
            }
            
            document.getElementById('step' + currentStep + '-content').style.display = 'block';
            
            for (let i = 1; i <= totalSteps; i++) {
                const step = document.getElementById('step' + i);
                if (i <= currentStep) {
                    step.classList.remove('inactive');
                    step.classList.add('active');
                } else {
                    step.classList.remove('active');
                    step.classList.add('inactive');
                }
            }
        }

        function loadTemplate(industry) {
            const templates = {
                tech: { phone: 2000, it: 1500, implementation: 3, savings: 3500 },
                finance: { phone: 3000, it: 2000, implementation: 6, savings: 5000 },
                healthcare: { phone: 2500, it: 1800, implementation: 4, savings: 4000 },
                retail: { phone: 1800, it: 1200, implementation: 3, savings: 2800 },
                manufacturing: { phone: 2200, it: 1600, implementation: 5, savings: 3600 },
                logistics: { phone: 2800, it: 1400, implementation: 4, savings: 3800 }
            };
            
            const template = templates[industry];
            if (template) {
                document.getElementById('monthlyPhoneCosts').value = template.phone;
                document.getElementById('monthlyITCosts').value = template.it;
                document.getElementById('implementationTime').value = template.implementation;
                document.getElementById('monthlySavings').value = template.savings;
                document.getElementById('industry').value = industry;
                
                showTab('calculator');
                currentStep = 2;
                updateStepDisplay();
            }
        }

        function calculateROI() {
            const phoneCosts = parseFloat(document.getElementById('monthlyPhoneCosts').value) || 0;
            const itCosts = parseFloat(document.getElementById('monthlyITCosts').value) || 0;
            const implementationCosts = parseFloat(document.getElementById('implementationCosts').value) || 0;
            const monthlySavings = parseFloat(document.getElementById('monthlySavings').value) || 0;
            const implementationTime = parseFloat(document.getElementById('implementationTime').value) || 1;
            
            const totalMonthlyCosts = phoneCosts + itCosts;
            const monthlyROI = monthlySavings - totalMonthlyCosts;
            const yearlyROI = monthlyROI * 12;
            const paybackPeriod = monthlyROI > 0 ? (implementationCosts / monthlyROI) : 0;
            
            const totalInvestment = implementationCosts;
            const totalReturn = (monthlySavings * 12) - (totalMonthlyCosts * 12);
            const roiPercentage = totalInvestment > 0 ? ((totalReturn - totalInvestment) / totalInvestment * 100) : 0;
            
            const totalSavingsYear1 = (monthlySavings * 12) - (totalMonthlyCosts * 12) - implementationCosts;
            
            const resultsDiv = document.getElementById('results-content');
            resultsDiv.innerHTML = `
                <div class="form-card">
                    <div class="results-grid">
                        <div class="result-card">
                            <h4>Monatlicher ROI</h4>
                            <div class="result-value">${monthlyROI.toFixed(2)} ‚Ç¨</div>
                        </div>
                        
                        <div class="result-card">
                            <h4>J√§hrlicher ROI</h4>
                            <div class="result-value">${yearlyROI.toFixed(2)} ‚Ç¨</div>
                        </div>
                        
                        <div class="result-card">
                            <h4>Amortisationszeit</h4>
                            <div class="result-value">${paybackPeriod > 0 ? paybackPeriod.toFixed(1) + ' Mon.' : 'N/A'}</div>
                        </div>
                        
                        <div class="result-card">
                            <h4>ROI in %</h4>
                            <div class="result-value">${roiPercentage.toFixed(1)} %</div>
                        </div>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">üìà ROI Entwicklung √ºber 24 Monate</div>
                    <div class="chart-placeholder">
                        üìä Interaktive Diagramme werden hier angezeigt
                    </div>
                </div>

                <div class="form-card">
                    <h2 style="color: var(--accent); margin-bottom: 1.5rem;">üìä Detaillierte Analyse</h2>
                    <div class="results-grid">
                        <div class="result-card">
                            <h4>Gesamtkosten Jahr 1</h4>
                            <div class="result-value">${((totalMonthlyCosts * 12) + implementationCosts).toFixed(2)} ‚Ç¨</div>
                        </div>
                        <div class="result-card">
                            <h4>Gesamteinsparungen Jahr 1</h4>
                            <div class="result-value">${(monthlySavings * 12).toFixed(2)} ‚Ç¨</div>
                        </div>
                        <div class="result-card">
                            <h4>Netto-Gewinn Jahr 1</h4>
                            <div class="result-value">${totalSavingsYear1.toFixed(2)} ‚Ç¨</div>
                        </div>
                        <div class="result-card">
                            <h4>Break-Even Punkt</h4>
                            <div class="result-value">${paybackPeriod > 0 ? 'Monat ' + Math.ceil(paybackPeriod) : 'N/A'}</div>
                        </div>
                    </div>
                </div>

                <div class="export-section">
                    <h3>üìÑ Ergebnisse exportieren</h3>
                    <button class="btn" onclick="exportToPDF()">üìÑ PDF Download</button>
                    <button class="btn" onclick="exportToExcel()">üìä Excel Download</button>
                    <button class="btn btn-secondary" onclick="shareResults()">üîó Teilen</button>
                </div>
            `;
            
            resultsDiv.style.display = 'block';
            showTab('results');
        }

        function exportToPDF() {
            alert('PDF Export wird implementiert...');
        }

        function exportToExcel() {
            alert('Excel Export wird implementiert...');
        }

        function shareResults() {
            alert('Share-Funktion wird implementiert...');
        }

        document.addEventListener('DOMContentLoaded', function() {
            updateStepDisplay();
        });
    </script>
</body>
</html>

    <!-- Add Export Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script>
        // Enhanced Export Functions
        function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Get calculation results
            const phoneCosts = parseFloat(document.getElementById('monthlyPhoneCosts').value) || 0;
            const itCosts = parseFloat(document.getElementById('monthlyITCosts').value) || 0;
            const implementationCosts = parseFloat(document.getElementById('implementationCosts').value) || 0;
            const monthlySavings = parseFloat(document.getElementById('monthlySavings').value) || 0;
            
            const monthlyROI = monthlySavings - (phoneCosts + itCosts);
            const yearlyROI = monthlyROI * 12;
            const paybackPeriod = monthlyROI > 0 ? (implementationCosts / monthlyROI) : 0;
            
            // PDF Content
            doc.setFontSize(20);
            doc.text('VaaS ROI Calculator - Ergebnisbericht', 20, 30);
            
            doc.setFontSize(12);
            doc.text(`Datum: ${new Date().toLocaleDateString('de-DE')}`, 20, 50);
            
            doc.text('KOSTENANALYSE:', 20, 70);
            doc.text(`‚Ä¢ Monatliche Telefoniekosten: ${phoneCosts.toFixed(2)} ‚Ç¨`, 25, 80);
            doc.text(`‚Ä¢ Monatliche IT-Kosten: ${itCosts.toFixed(2)} ‚Ç¨`, 25, 90);
            doc.text(`‚Ä¢ Implementierungskosten: ${implementationCosts.toFixed(2)} ‚Ç¨`, 25, 100);
            
            doc.text('ROI ERGEBNISSE:', 20, 120);
            doc.text(`‚Ä¢ Monatlicher ROI: ${monthlyROI.toFixed(2)} ‚Ç¨`, 25, 130);
            doc.text(`‚Ä¢ J√§hrlicher ROI: ${yearlyROI.toFixed(2)} ‚Ç¨`, 25, 140);
            doc.text(`‚Ä¢ Amortisationszeit: ${paybackPeriod > 0 ? paybackPeriod.toFixed(1) + ' Monate' : 'N/A'}`, 25, 150);
            
            doc.save('VaaS_ROI_Berechnung.pdf');
        }

        function exportToExcel() {
            const phoneCosts = parseFloat(document.getElementById('monthlyPhoneCosts').value) || 0;
            const itCosts = parseFloat(document.getElementById('monthlyITCosts').value) || 0;
            const implementationCosts = parseFloat(document.getElementById('implementationCosts').value) || 0;
            const monthlySavings = parseFloat(document.getElementById('monthlySavings').value) || 0;
            
            const monthlyROI = monthlySavings - (phoneCosts + itCosts);
            const yearlyROI = monthlyROI * 12;
            const paybackPeriod = monthlyROI > 0 ? (implementationCosts / monthlyROI) : 0;
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            
            // Input data
            const inputData = [
                ['VaaS ROI Calculator - Eingabedaten', ''],
                ['', ''],
                ['Parameter', 'Wert'],
                ['Monatliche Telefoniekosten (‚Ç¨)', phoneCosts],
                ['Monatliche IT-Kosten (‚Ç¨)', itCosts],
                ['Implementierungskosten (‚Ç¨)', implementationCosts],
                ['Erwartete monatliche Einsparungen (‚Ç¨)', monthlySavings]
            ];
            
            // Results data
            const resultsData = [
                ['', ''],
                ['ROI Ergebnisse', ''],
                ['Kennzahl', 'Wert'],
                ['Monatlicher ROI (‚Ç¨)', monthlyROI.toFixed(2)],
                ['J√§hrlicher ROI (‚Ç¨)', yearlyROI.toFixed(2)],
                ['Amortisationszeit (Monate)', paybackPeriod > 0 ? paybackPeriod.toFixed(1) : 'N/A'],
                ['ROI Prozent (%)', ((yearlyROI / implementationCosts) * 100).toFixed(1)]
            ];
            
            const allData = [...inputData, ...resultsData];
            const ws = XLSX.utils.aoa_to_sheet(allData);
            
            XLSX.utils.book_append_sheet(wb, ws, 'ROI Berechnung');
            XLSX.writeFile(wb, 'VaaS_ROI_Berechnung.xlsx');
        }

        function shareResults() {
            const phoneCosts = parseFloat(document.getElementById('monthlyPhoneCosts').value) || 0;
            const itCosts = parseFloat(document.getElementById('monthlyITCosts').value) || 0;
            const monthlySavings = parseFloat(document.getElementById('monthlySavings').value) || 0;
            const monthlyROI = monthlySavings - (phoneCosts + itCosts);
            const yearlyROI = monthlyROI * 12;
            
            const shareText = `VaaS ROI Berechnung:\n\n` +
                            `üí∞ Monatlicher ROI: ${monthlyROI.toFixed(2)} ‚Ç¨\n` +
                            `üìà J√§hrlicher ROI: ${yearlyROI.toFixed(2)} ‚Ç¨\n\n` +
                            `Berechnet mit dem VaaS ROI Calculator`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'VaaS ROI Berechnung',
                    text: shareText,
                    url: window.location.href
                });
            } else {
                // Fallback: Copy to clipboard
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('Ergebnisse in die Zwischenablage kopiert!');
                });
            }
        }
    </script>
